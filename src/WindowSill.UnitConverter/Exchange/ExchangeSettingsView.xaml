<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="WindowSill.UnitConverter.Exchange.ExchangeSettingsView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:converters="using:CommunityToolkit.WinUI.Converters"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:api="using:WindowSill.API"
    xmlns:local="using:WindowSill.UnitConverter.Exchange"
    VerticalAlignment="Stretch"
    VerticalContentAlignment="Stretch"
    mc:Ignorable="d">
    <UserControl.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:BoolNegationConverter x:Key="BoolNegationConverter"/>
    </UserControl.Resources>

    <Grid
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        ColumnSpacing="8"
        RowSpacing="8"
        MinHeight="200">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock
            Grid.Row="0"
            Style="{ThemeResource BodyStrongTextBlockStyle}"
            api:Uids.Uid="/WindowSill.UnitConverter/Exchange/FavoriteInto"/>
        <CommandBar
            Grid.Row="1"
            IsOpen="False"
            DefaultLabelPosition="Right"
            HorizontalAlignment="Left">
            <AppBarButton
                Icon="Add"
                IsEnabled="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource BoolNegationConverter}}"
                api:Uids.Uid="/WindowSill.UnitConverter/Exchange/Add"
                Click="AddButton_Click"/>
        </CommandBar>

        <ProgressRing
            Grid.Row="2"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
            Width="32"
            Height="32"
            Visibility="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
        <ItemsControl
            Grid.Row="2"
            ItemsSource="{x:Bind ViewModel.FavoriteIsoCurrencyCodes, Mode=OneWay}">
            <ItemsControl.ItemContainerTransitions>
                <TransitionCollection>
                    <ReorderThemeTransition/>
                </TransitionCollection>
            </ItemsControl.ItemContainerTransitions>
            <ItemsControl.ItemTemplate>
                <DataTemplate x:DataType="local:CurrencyValue">
                    <controls:SettingsCard
                        Header="{x:Bind Currency}"
                        Description="{x:Bind IsoCurrency}">
                        <StackPanel
                            Orientation="Horizontal"
                            Spacing="8">
                            <Button
                                Height="32"
                                Width="40"
                                Padding="0"
                                api:Uids.Uid="/WindowSill.UnitConverter/Exchange/MoveUp"
                                Content="{ui:FontIcon FontFamily={StaticResource SegoeFluentIcons}, Glyph=&#xE70E;, FontSize=16}"
                                Click="MoveUpButton_Click"/>
                            <Button
                                Height="32"
                                Width="40"
                                Padding="0"
                                api:Uids.Uid="/WindowSill.UnitConverter/Exchange/MoveDown"
                                Content="{ui:FontIcon FontFamily={StaticResource SegoeFluentIcons}, Glyph=&#xE70D;, FontSize=16}"
                                Click="MoveDownButton_Click"/>
                            <Button
                                Height="32"
                                Width="40"
                                Padding="0"
                                api:Uids.Uid="/WindowSill.UnitConverter/Exchange/Delete"
                                Content="{ui:FontIcon FontFamily={StaticResource SegoeFluentIcons}, Glyph=&#xE74D;, FontSize=16}"
                                Click="DeleteButton_Click"/>
                        </StackPanel>
                    </controls:SettingsCard>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</UserControl>
